# 小红书蒲公英 API 使用建议

## 一、并发配置

```json
{
  "concurrency": 5,
  "timeout": 30,
  "retry_count": 3,
  "retry_delay": 2
}
```

- **并发数**: 5 个（避免触发限流）
- **超时时间**: 30 秒
- **重试次数**: 3 次
- **重试间隔**: 2 秒

## 二、缓存策略

**强烈建议**: 所有接口调用时添加 `acceptCache=true` 参数

- 缓存可以显著减少 API 调用成本
- 对于 KOL 基础信息等变化不频繁的数据，缓存效果最佳
- 实时性要求高的数据（如粉丝趋势）可以不使用缓存

## 三、接口优先级

### 高优先级（必调）
1. `get-kol-info/v1` - KOL 基础信息
2. `get-kol-fans-portrait/v1` - 粉丝画像（评估目标用户匹配度）
3. `api/solar/note/noteId/detail/v1` - 笔记详情（评估内容质量）

### 中优先级（推荐）
4. `get-kol-fans-summary/v1` - 粉丝分析（评估粉丝质量）
5. `get-kol-data-summary/v2` - 数据概览（全面了解 KOL）
6. `get-kol-note-rate/v1` - 笔记数据率（评估内容表现）

### 低优先级（可选）
7. `get-kol-fans-trend/v1` - 粉丝趋势
8. `get-kol-core-data/v1` - 核心数据
9. `get-kol-note-list/v1` - 笔记列表

## 四、接口可用性汇总

| 接口 | 状态 | 备注 |
|------|------|------|
| `get-kol-info/v1` | ✅ | KOL 基础信息 |
| `get-kol-note-rate/v1` | ✅ | KOL 笔记数据率 |
| `get-kol-fans-portrait/v1` | ✅ | KOL 粉丝画像 |
| `get-kol-fans-summary/v1` | ✅ | KOL 粉丝分析 |
| `get-kol-fans-trend/v1` | ✅ | KOL 粉丝趋势 |
| `get-kol-track/v1` | ❌ | **已下线** |
| `get-kol-note-list/v1` | ⚠️ | 仅蒲公英博主有效 |
| `get-kol-data-summary/v1` | ✅ | KOL 数据概览 V1 |
| `get-kol-data-summary/v2` | ✅ | KOL 数据概览 V2 |
| `get-kol-cost-effective/v1` | ✅ | KOL 性价比分析 |
| `get-kol-core-data/v1` | ✅ | KOL 核心数据 |
| `get-note-detail/v1` | ❌ | **已废弃** |
| `notes_detail_v2` | ⚠️ | 仅蒲公英博主有效 |
| `note_detail_solar` | ✅ | 笔记详情（推荐） |

**统计**: 可用 10个 ✅ | 受限 2个 ⚠️ | 不可用 2个 ❌

## 五、ID 获取流程

```
搜索笔记 → 提取 widgets_context.author_id → 作为 kolId/userId 使用
         → 提取 note.id → 作为 noteId 使用
```

**注意**: `author_id` = `kolId` = `userId`，可以互换使用

## 六、失败处理机制

1. **单次失败**: 等待 2 秒后重试
2. **连续失败**: 记录失败的 ID，后续单独补充调用
3. **批量调用**: 每调用一个接口立即保存结果，避免整体失败导致数据丢失

## 七、调用成本估算

假设要分析 100 个 KOL：

| 接口 | 调用次数 | 说明 |
|------|----------|------|
| kol_info | 100 | 每个 KOL 1 次 |
| kol_fans_portrait | 100 | 每个 KOL 1 次 |
| kol_fans_summary | 100 | 每个 KOL 1 次 |
| kol_data_summary_v2 | 100 | 每个 KOL 1 次 |
| note_detail_solar | 300 | 每个 KOL 取 3 篇笔记 |
| **总计** | **700** | - |

## 八、数据更新频率建议

| 数据类型 | 更新频率 | 说明 |
|----------|----------|------|
| KOL 基础信息 | 每周 1 次 | 变化较慢 |
| 粉丝画像 | 每周 1 次 | 变化较慢 |
| 粉丝趋势 | 每日 1 次 | 需要跟踪增长 |
| 笔记详情 | 每日 1 次 | 互动数据变化快 |
